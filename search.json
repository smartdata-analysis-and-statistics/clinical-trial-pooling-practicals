[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Welcome",
    "section": "",
    "text": "Welcome to the Practicals\nThis site hosts practical exercises and materials for the course Advanced Pooled Analyses for Clinical Trial Statisticians."
  },
  {
    "objectID": "hiearachical_modeling.html",
    "href": "hiearachical_modeling.html",
    "title": "Hierarchical Modeling",
    "section": "",
    "text": "In this example, we consider a scenario in which all trials are homogeneous — that is, they share similar designs, patient populations, and a consistent treatment effect.\n\n\nWe simulate 5 trials, each with the following characteristics:\n\n1:1 randomization between treatment and control arms\n\nPatients drawn from the same underlying population\n\nIdentical baseline severity distribution across trials\n\nA constant treatment effect with no variation across trials\n\n\nlibrary(dplyr)\nlibrary(ggplot2)\nsource(\"R/simulate_trials.R\")\n\n# Simulate 5 trials with 100 patients each (50 per arm)\ndf &lt;- simulate_trials(\n  baseline_means = rep(25, 5) , # Common mean baseline\n  trial_intercepts = rep(0,5), # No heterogeneity in outcome levels\n  cfb_active = rep(-9.6,5),\n  cfb_control = rep(-7.8,5),\n  n_per_arm = 50\n)\n\n\n\n\n\n\nTrial\nN\nBaseline (Active) Mean (SD)\nBaseline (Control) Mean (SD)\nBaseline (Overall) Mean (SD)\n\n\n\n\nTrial_1\n100\n26.1 (7.0)\n23.9 (7.2)\n25.0 (7.1)\n\n\nTrial_2\n100\n24.4 (6.8)\n25.7 (7.0)\n25.1 (6.9)\n\n\nTrial_3\n100\n25.5 (6.5)\n24.8 (7.5)\n25.2 (7.0)\n\n\nTrial_4\n100\n26.6 (7.1)\n23.6 (7.6)\n25.1 (7.4)\n\n\nTrial_5\n100\n25.8 (4.9)\n25.2 (6.6)\n25.5 (5.8)\n\n\n\n\n\n\n\n\nFigure 1 visualizes the relationship between baseline severity and change from baseline within each treatment arm using a naively pooled analysis.\n\n\n\n\n\n\n\n\nFigure 1: Observed Change from Baseline in Scenario 1\n\n\n\n\n\nThe plot shows that:\n\nThe mean change in the active group is -10\nThe mean change in the control group is -7.6\n\n\n\nWe begin by estimating the pooled treatment effect using a simple regression model that adjusts for baseline severity but ignores trial structure. This reflects a naive analysis:\n\n((fit_naive &lt;- glm(outcome ~ trta + baseline, data = df)))\n\n\nCall:  glm(formula = outcome ~ trta + baseline, data = df)\n\nCoefficients:\n(Intercept)   trtaActive     baseline  \n    -7.5005      -2.4818       0.9979  \n\nDegrees of Freedom: 499 Total (i.e. Null);  497 Residual\nNull Deviance:      36140 \nResidual Deviance: 12620    AIC: 3041\n\n\nIn this naive model, the estimated treatment effect is:\nTreatment effect: -2.48 (95% CI: -3.37 to -1.60)\nThe figure below visualizes fit_naive by showing predicted outcomes across baseline severity values for each treatment group, alongside the observed data.\n\n\n\n\n\n\n\n\nFigure 2: Model-Predicted and Observed Outcomes from Naive Pooled Analysis by Treatment Group\n\n\n\n\n\n\n\n\nNext, we fit a stratified model that accounts for trial-specific intercepts by including trial as a fixed effect (without a global intercept). This approach allows each trial to have its own baseline level of the outcome, effectively adjusting for differences in average outcomes across trials.\n\n((fit_stratified &lt;- glm(outcome ~ -1 + trial + trta + baseline, data = df)))\n\n\nCall:  glm(formula = outcome ~ -1 + trial + trta + baseline, data = df)\n\nCoefficients:\ntrialTrial_1  trialTrial_2  trialTrial_3  trialTrial_4  trialTrial_5  \n     -7.3626       -7.7004       -7.0886       -7.7760       -7.5772  \n  trtaActive      baseline  \n     -2.4819        0.9979  \n\nDegrees of Freedom: 500 Total (i.e. Null);  493 Residual\nNull Deviance:      170100 \nResidual Deviance: 12590    AIC: 3048\n\n\nThis model yields the following treatment effect estimate (trtaActive), which is adjusted for trial-level differences and baseline covariates.\nTreatment effect: -2.48 (95% CI: -3.37 to -1.59)\nNote that all trial-specific intercepts are fairly similar (ranging from approximately -7.78 to -7.09), which suggests there is no strong ‘trial effect’ in the data. This is consistent with how the data were simulated — the underlying outcome-generating mechanism assumed comparable average outcomes across trials, apart from random noise.\nThe homogeneity in trial-specific intercepts suggests that a naively pooled model with a global intercept could be reasonable in this scenario. However, this remains a strong assumption — even small differences across trials can introduce bias if not properly accounted for. Stratifying by trial offers a more robust approach by explicitly modeling these differences, even when they appear minor."
  },
  {
    "objectID": "hiearachical_modeling.html#simulating-data",
    "href": "hiearachical_modeling.html#simulating-data",
    "title": "Hierarchical Modeling",
    "section": "",
    "text": "We simulate 5 trials, each with the following characteristics:\n\n1:1 randomization between treatment and control arms\n\nPatients drawn from the same underlying population\n\nIdentical baseline severity distribution across trials\n\nA constant treatment effect with no variation across trials\n\n\nlibrary(dplyr)\nlibrary(ggplot2)\nsource(\"R/simulate_trials.R\")\n\n# Simulate 5 trials with 100 patients each (50 per arm)\ndf &lt;- simulate_trials(\n  baseline_means = rep(25, 5) , # Common mean baseline\n  trial_intercepts = rep(0,5), # No heterogeneity in outcome levels\n  cfb_active = rep(-9.6,5),\n  cfb_control = rep(-7.8,5),\n  n_per_arm = 50\n)\n\n\n\n\n\n\nTrial\nN\nBaseline (Active) Mean (SD)\nBaseline (Control) Mean (SD)\nBaseline (Overall) Mean (SD)\n\n\n\n\nTrial_1\n100\n26.1 (7.0)\n23.9 (7.2)\n25.0 (7.1)\n\n\nTrial_2\n100\n24.4 (6.8)\n25.7 (7.0)\n25.1 (6.9)\n\n\nTrial_3\n100\n25.5 (6.5)\n24.8 (7.5)\n25.2 (7.0)\n\n\nTrial_4\n100\n26.6 (7.1)\n23.6 (7.6)\n25.1 (7.4)\n\n\nTrial_5\n100\n25.8 (4.9)\n25.2 (6.6)\n25.5 (5.8)"
  },
  {
    "objectID": "hiearachical_modeling.html#estimating-the-pooled-treatment-effect",
    "href": "hiearachical_modeling.html#estimating-the-pooled-treatment-effect",
    "title": "Hierarchical Modeling",
    "section": "",
    "text": "Figure 1 visualizes the relationship between baseline severity and change from baseline within each treatment arm using a naively pooled analysis.\n\n\n\n\n\n\n\n\nFigure 1: Observed Change from Baseline in Scenario 1\n\n\n\n\n\nThe plot shows that:\n\nThe mean change in the active group is -10\nThe mean change in the control group is -7.6\n\n\n\nWe begin by estimating the pooled treatment effect using a simple regression model that adjusts for baseline severity but ignores trial structure. This reflects a naive analysis:\n\n((fit_naive &lt;- glm(outcome ~ trta + baseline, data = df)))\n\n\nCall:  glm(formula = outcome ~ trta + baseline, data = df)\n\nCoefficients:\n(Intercept)   trtaActive     baseline  \n    -7.5005      -2.4818       0.9979  \n\nDegrees of Freedom: 499 Total (i.e. Null);  497 Residual\nNull Deviance:      36140 \nResidual Deviance: 12620    AIC: 3041\n\n\nIn this naive model, the estimated treatment effect is:\nTreatment effect: -2.48 (95% CI: -3.37 to -1.60)\nThe figure below visualizes fit_naive by showing predicted outcomes across baseline severity values for each treatment group, alongside the observed data.\n\n\n\n\n\n\n\n\nFigure 2: Model-Predicted and Observed Outcomes from Naive Pooled Analysis by Treatment Group\n\n\n\n\n\n\n\n\nNext, we fit a stratified model that accounts for trial-specific intercepts by including trial as a fixed effect (without a global intercept). This approach allows each trial to have its own baseline level of the outcome, effectively adjusting for differences in average outcomes across trials.\n\n((fit_stratified &lt;- glm(outcome ~ -1 + trial + trta + baseline, data = df)))\n\n\nCall:  glm(formula = outcome ~ -1 + trial + trta + baseline, data = df)\n\nCoefficients:\ntrialTrial_1  trialTrial_2  trialTrial_3  trialTrial_4  trialTrial_5  \n     -7.3626       -7.7004       -7.0886       -7.7760       -7.5772  \n  trtaActive      baseline  \n     -2.4819        0.9979  \n\nDegrees of Freedom: 500 Total (i.e. Null);  493 Residual\nNull Deviance:      170100 \nResidual Deviance: 12590    AIC: 3048\n\n\nThis model yields the following treatment effect estimate (trtaActive), which is adjusted for trial-level differences and baseline covariates.\nTreatment effect: -2.48 (95% CI: -3.37 to -1.59)\nNote that all trial-specific intercepts are fairly similar (ranging from approximately -7.78 to -7.09), which suggests there is no strong ‘trial effect’ in the data. This is consistent with how the data were simulated — the underlying outcome-generating mechanism assumed comparable average outcomes across trials, apart from random noise.\nThe homogeneity in trial-specific intercepts suggests that a naively pooled model with a global intercept could be reasonable in this scenario. However, this remains a strong assumption — even small differences across trials can introduce bias if not properly accounted for. Stratifying by trial offers a more robust approach by explicitly modeling these differences, even when they appear minor."
  },
  {
    "objectID": "hiearachical_modeling.html#simulating-data-1",
    "href": "hiearachical_modeling.html#simulating-data-1",
    "title": "Hierarchical Modeling",
    "section": "2.1 Simulating Data",
    "text": "2.1 Simulating Data\nIn this scenario, we simulate five clinical trials that share a common treatment effect. However, the trials differ systematically in terms of participant eligibility criteria and overall prognosis:\n\nTrial 1 enrolls patients with the lowest baseline severity (mean = 20) and has a +5 intercept shift, resulting in higher overall outcome scores.\nTrial 4 includes patients with moderately higher baseline severity (mean = 30) and includes a −10 intercept shift, reducing overall outcome scores.\nTrial 5 involves the most severely affected patients (mean baseline = 35) and applies a −15 intercept shift, resulting in even lower outcome levels.\n\nThese shifts simulate trials enrolling progressively more severe populations, which report lower average outcomes across both treatment arms — despite having the same true treatment effect. This setup reflects a realistic source of between-trial heterogeneity.\n\n# Simulate 5 trials with 100 patients each (50 per arm)\ndf &lt;- simulate_trials(\n  baseline_means = c(20, 25, 25, 30, 35),     \n  trial_intercepts = c(5, 0, 0, -10, -15),  \n  cfb_active = rep(-9.6,5),\n  cfb_control = rep(-7.8,5),\n  n_per_arm = 50\n)\n\n\n\n\n\n\nTrial\nN\nBaseline (Active) Mean (SD)\nBaseline (Control) Mean (SD)\nBaseline (Overall) Mean (SD)\n\n\n\n\nTrial_1\n100\n20.9 (6.0)\n19.0 (6.1)\n20.0 (6.1)\n\n\nTrial_2\n100\n24.4 (6.8)\n25.7 (7.0)\n25.1 (6.9)\n\n\nTrial_3\n100\n25.5 (6.5)\n24.8 (7.5)\n25.2 (7.0)\n\n\nTrial_4\n100\n31.8 (8.1)\n28.4 (8.7)\n30.1 (8.5)\n\n\nTrial_5\n100\n36.0 (6.3)\n35.3 (8.5)\n35.7 (7.5)"
  },
  {
    "objectID": "hiearachical_modeling.html#estimating-the-pooled-treatment-effect-1",
    "href": "hiearachical_modeling.html#estimating-the-pooled-treatment-effect-1",
    "title": "Hierarchical Modeling",
    "section": "2.2 Estimating the Pooled Treatment Effect",
    "text": "2.2 Estimating the Pooled Treatment Effect\nFigure 3 visualizes the relationship between baseline severity and change from baseline within each treatment arm. The figure shows that:\n\nPatients with higher baseline severity tend to show larger improvements (greater negative change).\nThe active treatment group consistently shows a greater mean improvement than the control group, across all levels of baseline severity.\n\nAlthough no effect modification was simulated in this scenario, the figure illustrates how even pooled data can suggest patterns that may reflect underlying trial design or population heterogeneity.\n\n\n\n\n\n\n\n\nFigure 3: Observed Change from Baseline in Scenario 2.\n\n\n\n\n\n\n2.2.1 Naive Analysis\nWe again begin by estimating the pooled treatment effect using a simple regression model that adjusts for baseline severity but ignores potential heterogeneity across trials — that is, it assumes all patients come from a single trial.\n\nfit_naive &lt;- glm(outcome ~ trta + baseline, data = df)\n\nIn this naive model, we obtain:\nTreatment effect: -1.96 (95% CI: -3.34 to -0.57)\nThis result suggests a beneficial treatment effect, but it ignores systematic differences between trials — such as varying patient populations or outcome levels — which can lead to biased estimates.\nThe figure below visualizes fit_naive by showing predicted outcomes across baseline severity values for each treatment group, alongside the observed data.\n\n\n\n\n\n\n\n\nFigure 4: Model-Predicted and Observed Outcomes from Naive Pooled Analysis by Treatment Group\n\n\n\n\n\nGiven the data observed in Figure 3, we may think that there is effect modification by baseline severity, with the treatment effect appearing larger in patients with higher baseline severity. We can estimate this as follows:\n\nfit_naive_hte &lt;- glm(outcome ~ trta + baseline + trta*baseline, data = df)\n\n\n\n2.2.2 Stratified Analysis by Trial\nTo better account for between-trial differences, we now fit a stratified regression model by including trial-specific intercepts (i.e., one intercept per trial):\n\n((fit_stratified &lt;- glm(outcome ~ -1 + trial + trta + baseline, data = df)))\n\n\nCall:  glm(formula = outcome ~ -1 + trial + trta + baseline, data = df)\n\nCoefficients:\ntrialTrial_1  trialTrial_2  trialTrial_3  trialTrial_4  trialTrial_5  \n     -2.3723       -7.6997       -7.0878      -17.7647      -22.5552  \n  trtaActive      baseline  \n     -2.4817        0.9979  \n\nDegrees of Freedom: 500 Total (i.e. Null);  493 Residual\nNull Deviance:      145300 \nResidual Deviance: 12590    AIC: 3048\n\n\nThis model allows each trial to have its own average outcome level at baseline, while still estimating a common treatment effect and adjusting for baseline severity.\nLet’s visualize the stratified model predictions to understand how trial-specific baselines affect the outcome estimates.\n\nplot_outcome_predictions_by_treatment(fit_stratified)\n\n\n\n\n\n\n\nFigure 5: Observed and model-predicted outcomes by treatment group, with trial-specific intercepts. Each line represents a trial-level regression adjusted for baseline severity.\n\n\n\n\n\nThis plot illustrates how each trial follows its own fitted regression line, while the treatment effect (i.e., the difference between active and control) remains consistent across trials.\nAs shown in Figure 5, the trial-specific intercepts range from approximately -22.56 to -2.37, reflecting substantial differences in outcome levels across trials at baseline. These shifts arise from differences in the trial populations and illustrate why a naive pooled analysis (which ignores these differences) is inappropriate.\nThis substantial variation indicates that a naive pooling approach is no longer appropriate. Stratifying by trial ensures these baseline differences are accounted for, improving the validity of the treatment effect estimate.\nThe naive model estimated a treatment effect of -1.96 (SE = 0.71), without accounting for trial heterogeneity. In contrast, the stratified model — which adjusts for between-trial differences — yields a more precise estimate of -2.48 (SE = 0.45).\n\n\n2.2.3 Random trial effects\nInstead of estimating a separate fixed intercept for each trial, we can model trial-specific intercepts as random effects. This approach assumes that the intercepts for each trial are not unique parameters but are instead drawn from a common normal distribution. In practice, this means we estimate only the mean and standard deviation of the trial intercepts — reducing the number of parameters and increasing efficiency, especially when the number of trials is large or when each trial has limited data.\n\nlibrary(lme4)\n((fit_random &lt;- lmer(outcome ~  trta + baseline + (1|trial), data = df)))\n\nLinear mixed model fit by REML ['lmerMod']\nFormula: outcome ~ trta + baseline + (1 | trial)\n   Data: df\nREML criterion at convergence: 3064.33\nRandom effects:\n Groups   Name        Std.Dev.\n trial    (Intercept) 8.318   \n Residual             5.053   \nNumber of obs: 500, groups:  trial, 5\nFixed Effects:\n(Intercept)   trtaActive     baseline  \n   -11.4222      -2.4787       0.9951  \n\n\nRecall the stratified model — which adjusts for between-trial differences — yielded a treatment effect of -2.48 (SE = 0.45). The random effects model produces a similar point estimate of -2.48, with the same standard error (SE = 0.45).\nAlthough the results align in this example, the two approaches rely on different assumptions — and in other contexts, these assumptions can materially affect the estimated treatment effect.\nThe global fixed-effect estimates from the random-effects model are:\n\nfixef(fit_random)\n\n(Intercept)  trtaActive    baseline \n -11.422190   -2.478738    0.995145 \n\n\nThese represent the overall average outcome level, treatment effect, and baseline slope across all trials.\nWe can extract the trial-specific intercept deviations from the global mean intercept (-11.42) as follows.\n\nranef(fit_random)\n\n$trial\n        (Intercept)\nTrial_1    9.070208\nTrial_2    3.776434\nTrial_3    4.386367\nTrial_4   -6.237760\nTrial_5  -10.995250\n\nwith conditional variances for \"trial\" \n\n\nBy design, the mean of these random effects is zero.\nWhile the random effects approach is attractive for its parsimony and ability to borrow strength across trials, it can introduce bias in the trial-specific intercept terms (and thereby introduce bias in the pooled treatment effect). In the table below, we compare the intercepts estimated by the stratified model (fixed effects) with those from the random effects model.\n\n\n\n\nTable 1: Comparison of Trial-Specific Intercepts Estimated from Stratified and Random Effects Models.\n\n\n\n\n\n\nTrial\nIntercept (Stratified Trial Effects)\nIntercept (Random Trial Effects)\n\n\n\n\nTrial_1\n-2.37\n-2.35\n\n\nTrial_2\n-7.70\n-7.65\n\n\nTrial_3\n-7.09\n-7.04\n\n\nTrial_4\n-17.76\n-17.66\n\n\nTrial_5\n-22.56\n-22.42\n\n\n\n\n\n\n\n\nAs shown in Table 1, the estimated trial intercepts differ slightly between the stratified model and the random-intercepts model. The stratified model estimates a separate fixed intercept for each trial, capturing trial-specific baseline differences directly. In contrast, the random-effects model assumes that intercepts arise from a common distribution, and applies shrinkage toward the overall mean.\nThis shrinkage reduces variability across trials and can lead to bias in the estimated intercepts – particularly if true trial effects differ systematically. This is reflected in the standard deviations of the trial intercepts: 8.35 for the stratified model versus 8.30 under the random-effects model, confirming a modest degree of shrinkage. Although this reduction in variability appears small, even modest shrinkage can introduce bias in the treatment effect estimate – especially when trial-level outcome differences are correlated with treatment assignment or patient characteristics. This risk is why, in pooled analyses and multi-trial synthesis, stratifying by trial using fixed effects is often preferred. Fixed-effect models estimate each trial’s intercept independently, thus preserving true baseline differences and avoiding bias introduced by shrinkage."
  },
  {
    "objectID": "hiearachical_modeling.html#simulating-data-2",
    "href": "hiearachical_modeling.html#simulating-data-2",
    "title": "Hierarchical Modeling",
    "section": "3.1 Simulating Data",
    "text": "3.1 Simulating Data\nIn this scenario, we simulate five clinical trials that are identical in design and treatment effect. However, Trials 4 and 5 differ systematically from Trials 1–3:\n\nTrial 1 enrolls patients with the lowest baseline severity (mean = 20) and has a +5 intercept shift, indicating higher overall outcomes.\nTrial 4 enrolls patients with moderately higher baseline severity (mean = 30) and includes a −10 intercept shift, lowering overall outcomes.\nTrial 5 enrolls patients with the highest baseline severity (mean = 35) and includes a stronger −15 intercept shift to further reduce outcome levels.\n\nThese shifts simulate trials that include more severely affected populations and report lower outcome scores across both treatment arms, despite having the same true treatment effect. This setup reflects a realistic source of between-trial heterogeneity.\n\ndf &lt;- simulate_trials(\n  baseline_means = c(20, 25, 25, 30, 35),     \n  trial_intercepts = c(5, 0, 0, -10, -15),\n  cfb_active = rep(-9.6,5),\n  cfb_control = rep(-7.8,5),\n  n_per_arm = 50,\n  beta_W = rep(-0.15,5),  \n  beta_A = 0.35,\n  seed = 2025\n)\n\n\n\n\n\n\nTrial\nN\nBaseline (Active) Mean (SD)\nBaseline (Control) Mean (SD)\nBaseline (Overall) Mean (SD)\n\n\n\n\nTrial_1\n100\n20.9 (6.0)\n19.0 (6.1)\n20.0 (6.1)\n\n\nTrial_2\n100\n24.4 (6.8)\n25.7 (7.0)\n25.1 (6.9)\n\n\nTrial_3\n100\n25.5 (6.5)\n24.8 (7.5)\n25.2 (7.0)\n\n\nTrial_4\n100\n31.8 (8.1)\n28.4 (8.7)\n30.1 (8.5)\n\n\nTrial_5\n100\n36.0 (6.3)\n35.3 (8.5)\n35.7 (7.5)"
  },
  {
    "objectID": "hiearachical_modeling.html#estimating-the-pooled-treatment-effect-2",
    "href": "hiearachical_modeling.html#estimating-the-pooled-treatment-effect-2",
    "title": "Hierarchical Modeling",
    "section": "3.2 Estimating the Pooled Treatment Effect",
    "text": "3.2 Estimating the Pooled Treatment Effect\nFigure 6 visualizes the relationship between baseline severity and change from baseline within each treatment arm. The figure shows that:\n\nPatients with higher baseline severity tend to show larger improvements (greater negative change).\nThe active treatment group shows a greater mean improvement than the control group.\n\n\n\n\n\n\n\n\n\nFigure 6: Observed Change from Baseline in Scenario 3."
  },
  {
    "objectID": "hiearachical_modeling.html#sec-stratifiedREmodel",
    "href": "hiearachical_modeling.html#sec-stratifiedREmodel",
    "title": "Hierarchical Modeling",
    "section": "3.3 Assessing Between-Trial Heterogeneity in Treatment Effects",
    "text": "3.3 Assessing Between-Trial Heterogeneity in Treatment Effects\nWe investigate between-trial heterogeneity in treatment effects using a linear mixed model with random slopes for treatment and fixed intercepts by trial:\n\nfit_random_hte &lt;- lmer(outcome ~ -1 + trial + baseline:trial + \n                         trt + (0 + trt | trial), data = df)\n\nIn this formula:\n\n-1 + trial: Includes a fixed intercept for each trial\nbaseline:trial: Allows each trial to have its own slope for baseline (trial-specific baseline effect)\ntrt: Estimates the average treatment effect across trials\n(0 + trt | trial): Allows the treatment effect to vary randomly by trial\n\nNote: The trt variable is modeled as a numeric binary indicator (0 = control, 1 = active treatment), rather than as a categorical factor. This allows us to directly interpret the fixed effect of trt as the average treatment effect. Additionally, modeling trt as numeric is necessary to estimate a random slope for trt per trial via (0 + trt | trial). This would not be valid if trt were treated as a factor (e.g., using trta).\nThe results are as follows:\n\n\nLinear mixed model fit by REML ['lmerMod']\nFormula: outcome ~ -1 + trial + baseline:trial + trt + (0 + trt | trial)\n   Data: df\nREML criterion at convergence: 3051.627\nRandom effects:\n Groups   Name Std.Dev.\n trial    trt  0.3575  \n Residual      5.0977  \nNumber of obs: 500, groups:  trial, 5\nFixed Effects:\n         trialTrial_1           trialTrial_2           trialTrial_3  \n              -2.2450                -6.4129                -6.9032  \n         trialTrial_4           trialTrial_5                    trt  \n             -17.2160               -14.7140                -2.5472  \ntrialTrial_1:baseline  trialTrial_2:baseline  trialTrial_3:baseline  \n               0.8721                 0.9206                 0.9626  \ntrialTrial_4:baseline  trialTrial_5:baseline  \n               1.0096                 0.8546  \n\n\nWe compute the 95% confidence interval for the average treatment effect and a prediction interval that reflects heterogeneity across trials. The prediction interval estimates the range where a future trial’s treatment effect might fall.\n\n((ci_mu &lt;- confint(fit_random_hte, method = \"Wald\")[\"trt\", ]))\n\n    2.5 %    97.5 % \n-3.500926 -1.593567 \n\n\nTo derive an approximate 95% prediction interval for the treatment effect, we can use the following approach:\n\n# Extract mean treatment effect\nmu &lt;- fixef(fit_random_hte)[\"trt\"]\ntau2 &lt;- VarCorr(fit_random_hte)$trial[\"trt\", \"trt\"]\nvar_mu &lt;- vcov(fit_random_hte)[\"trt\", \"trt\"]\n\n# Number of studies\nn_studies &lt;- length(unique(df$trial))\ndf_t &lt;- n_studies - 2\n\n# t critical value for 95% PI\nt_crit &lt;- qt(0.975, df = df_t)\n\n# 95% Prediction Interval\npred_lower &lt;- mu - t_crit * sqrt(tau2 + var_mu)\npred_upper &lt;- mu + t_crit * sqrt(tau2 + var_mu)\n\ncbind(pred_lower, pred_upper)\n\n    pred_lower pred_upper\ntrt  -4.468743 -0.6257501\n\n\nThe prediction interval is wide, suggesting meaningful heterogeneity in treatment effects across trials. This implies that in some future settings, the treatment could be less effective compared to the pooled estimate.\nThe fitted effects and prediction interval are visualized in Figure 7.\n\n\n\n\n\n\n\n\nFigure 7: Trial-Specific Estimates from the Random-Effects Model. Estimated intercepts terms (left) and treatment effects (right) for each trial are shown, based on a linear mixed-effects model with fixed intercepts by trial and random slopes for treatment. The black points and lines represent point estimates and 95% confidence intervals. The pooled treatment effect estimate is shown at the bottom, with dashed red lines indicating the 95% prediction interval for a new trial."
  },
  {
    "objectID": "hiearachical_modeling.html#investigating-effect-modification",
    "href": "hiearachical_modeling.html#investigating-effect-modification",
    "title": "Hierarchical Modeling",
    "section": "3.4 Investigating effect modification",
    "text": "3.4 Investigating effect modification\nWe now explore whether the observed treatment effect heterogeneity can be explained by effect modification, using interaction terms between treatment and baseline severity.\n\n3.4.1 Common interaction effect\nA simple extension of our linear mixed model defined in Section 3.3 – with fixed intercepts per trial and random slopes for treatment – is to include a common treatment-by-baseline interaction term. This allows us to assess whether baseline severity modifies the treatment effect, assuming the interaction is constant across trials.\n\nfit_hte_1 &lt;- lmer(outcome ~ -1 + trial + baseline:trial + trt + \n                    baseline:trt + (0 + trt | trial) , data = df)\n\nIn this formula:\n\n-1 + trial: Fixed intercept per trial\nbaseline:trial: Fixed effect for baseline severity per trial\ntrt: Estimates the average treatment effect across trials\nbaseline:trt: Interaction between baseline severity and treatment\n(0 + trt | trial): Allows the treatment effect to vary randomly by trial\n\nThe results are as follows:\n\n\nLinear mixed model fit by REML ['lmerMod']\nFormula: outcome ~ -1 + trial + baseline:trial + trt + baseline:trt +  \n    (0 + trt | trial)\n   Data: df\nREML criterion at convergence: 3050.085\nRandom effects:\n Groups   Name Std.Dev.\n trial    trt  1.655   \n Residual      5.051   \nNumber of obs: 500, groups:  trial, 5\nFixed Effects:\n         trialTrial_1           trialTrial_2           trialTrial_3  \n              -3.5414                -8.6981                -8.6412  \n         trialTrial_4           trialTrial_5                    trt  \n             -19.4052               -16.6633                 1.8399  \ntrialTrial_1:baseline  trialTrial_2:baseline  trialTrial_3:baseline  \n               0.9613                 1.0010                 1.0315  \ntrialTrial_4:baseline  trialTrial_5:baseline           baseline:trt  \n               1.0793                 0.9112                -0.1610  \n\n\nThe coefficients trt and baseline:trt define a linear relationship between baseline severity and the estimated treatment effect (Active vs Control). In Figure 8, we visualize this relationship using the model’s fixed effects, with a dashed line indicating no treatment effect.\n\n\n\n\n\n\n\n\nFigure 8: Estimated treatment effect (active vs control) as a function of baseline severity. The red dashed line at 0 indicates no treatment benefit. Negative values suggest a favorable effect of the active treatment, while positive values suggest harm. The distribution of baseline values across the included trials is shown as rug marks along the x-axis. Colored dots represent the expected (marginal) treatment effect within each trial, calculated by averaging predicted outcomes across that trial’s observed baseline distribution.\n\n\n\n\n\nAlthough the model includes a treatment-by-baseline interaction (baseline:trt), there remains evidence of heterogeneity in treatment effect across trials. This is indicated by the random slope variance for treatment (trt | trial), with an estimated standard deviation of 1.65.\n\n\n3.4.2 Random within-study interaction effects\nIn this approach, we stratify all parameters except for the treatment-by-covariate interaction term by trial. This includes the parameter representing the treatment effect at the covariate’s reference value. All “nuisance” parameters (i.e., parameters not of primary interest) are allowed to vary across trials. A random effect is included only on the within-trial interaction term (baseline:trt), capturing heterogeneity in effect modification across trials.\n\nfit_hte_2 &lt;- lmer(outcome ~ -1 + trial + baseline:trial + trt:trial + \n                    baseline:trt + (0 + baseline:trt | trial) , data = df)\n\nThis stratification of all nuisance parameters – including the treatment effect at the covariate’s reference value — ensures that the estimate of baseline:trt (the treatment–covariate interaction) is informed purely by within-trial comparisons.\nThe fitted model is:\n\n\nLinear mixed model fit by REML ['lmerMod']\nFormula: outcome ~ -1 + trial + baseline:trial + trt:trial + baseline:trt +  \n    (0 + baseline:trt | trial)\n   Data: df\nREML criterion at convergence: 3031.288\nRandom effects:\n Groups   Name         Std.Dev.\n trial    baseline:trt 0.000   \n Residual              5.049   \nNumber of obs: 500, groups:  trial, 5\nFixed Effects:\n         trialTrial_1           trialTrial_2           trialTrial_3  \n              -3.7589                -9.2970                -9.0849  \n         trialTrial_4           trialTrial_5  trialTrial_1:baseline  \n             -20.0635               -17.4157                 0.9942  \ntrialTrial_2:baseline  trialTrial_3:baseline  trialTrial_4:baseline  \n               1.0233                 1.0515                 1.0959  \ntrialTrial_5:baseline       trialTrial_1:trt       trialTrial_2:trt  \n               0.9255                -0.2784                 3.1703  \n     trialTrial_3:trt       trialTrial_4:trt       trialTrial_5:trt  \n               2.6088                 4.6171                 5.2918  \n         baseline:trt  \n              -0.2066  \noptimizer (nloptwrap) convergence code: 0 (OK) ; 0 optimizer warnings; 1 lme4 warnings \n\n\nSince the between-trial variance in the interaction effects is close to zero, we may simplify the model by removing the random component and estimating a common interaction term across trials:\n\nfit_hte_2b &lt;- glm(outcome ~ -1 + trial + baseline:trial + trt:trial + \n                    baseline:trt, data = df)\n\nThe coefficients trt:trial and baseline:trt define a linear relationship between baseline severity and the estimated treatment effect (active vs control), with a trial-specific intercept and a common interaction slope. In Figure 9, we visualize this relationship using both model-predicted curves and trial-level marginal estimates.\n\n\n\n\n\n\n\n\nFigure 9: Estimated treatment effect (active vs control) as a function of baseline severity for each trial. The red dashed line at 0 indicates no treatment benefit. Negative values suggest a favorable effect of the active treatment, while positive values suggest harm. Rug marks show the distribution of baseline values. Coloured lines and dots represent, respectively, the model-based treatment-effect curves and the marginal (average) treatment effect within each trial.\n\n\n\n\n\n\n\n3.4.3 Distentangling within- and across-study interaction\nIn this approach, we decompose the covariate baseline into two components: a within-trial centered value (cbase) and a trial-level mean (xk_mean). Specifically, we define cbase = baseline - xk_mean and include both trt:cbase and xk_mean:trt in the model. The coefficient for trt:cbase captures the within-trial treatment–covariate interaction, while the coefficient for xk_mean:trt represents the between-trial effect of the trial-level covariate mean on treatment effect.\nBy explicitly modeling both components, this formulation separates within- and between-trial sources of interaction. As a result, the estimate of the within-trial interaction is not biased by between-trial heterogeneity in the covariate distribution (as is the case in Section 3.4.1). This is especially important in avoiding aggregation bias when interpreting effect modification.\n\nfit_hte_3 &lt;- lmer(outcome ~ -1 + trial + trt + trial:baseline + \n                    trt:cbase + xk_mean:trt +\n                    (0 + trt | trial) + (0 + trt:cbase | trial),\n                  data = df)\n\nThe fitted model is:\n\n\nLinear mixed model fit by REML ['lmerMod']\nFormula: \noutcome ~ -1 + trial + trt + trial:baseline + trt:cbase + xk_mean:trt +  \n    (0 + trt | trial) + (0 + trt:cbase | trial)\n   Data: df\nREML criterion at convergence: 3045.39\nRandom effects:\n Groups   Name      Std.Dev.\n trial    trt       0.000   \n trial.1  trt:cbase 0.000   \n Residual           5.044   \nNumber of obs: 500, groups:  trial, 5\nFixed Effects:\n         trialTrial_1           trialTrial_2           trialTrial_3  \n              -3.9838                -8.7689                -8.9990  \n         trialTrial_4           trialTrial_5                    trt  \n             -20.0136               -17.6781                -6.5584  \ntrialTrial_1:baseline  trialTrial_2:baseline  trialTrial_3:baseline  \n               0.9840                 1.0183                 1.0529  \ntrialTrial_4:baseline  trialTrial_5:baseline              trt:cbase  \n               1.1020                 0.9238                -0.2078  \n          trt:xk_mean  \n               0.1504  \noptimizer (nloptwrap) convergence code: 0 (OK) ; 0 optimizer warnings; 1 lme4 warnings \n\n\nSince the between-trial variance in the treatment effects and interaction effects is close to zero, we may simplify the model by removing the random components:\n\nfit_hte_3b &lt;- glm(outcome ~ -1 + trial + trt + trial:baseline + \n                    trt:cbase + trt:xk_mean, data = df)\n\nThe model includes two interaction terms: cbase:trt, which captures the within-trial interaction between the centered covariate and treatment; and xk_mean:trt, which captures the across-trial interaction effect due to variation in trial-level covariate means. Together, these coefficients define a linear relationship between baseline severity and the estimated treatment effect (active vs control), while distinguishing within- and between-trial sources of effect modification. In Figure 10, we visualize this relationship using both model-predicted curves and trial-level marginal treatment effect estimates.\n\n\n\n\n\n\n\n\nFigure 10: Estimated treatment effect (active vs control) as a function of baseline severity for each trial. The red dashed line at 0 indicates no treatment benefit. Negative values suggest a favorable effect of the active treatment, while positive values suggest harm. Rug marks show the distribution of baseline values. Coloured lines and dots represent, respectively, the model-based treatment-effect curves and the marginal (average) treatment effect within each trial. The dotted black line visualizes the across-trial interaction effect, showing how the average baseline severity across trials relates to the average treatment effect."
  },
  {
    "objectID": "computer_practical.html",
    "href": "computer_practical.html",
    "title": "Computer Practical",
    "section": "",
    "text": "Please complete the following setup steps on your computer:\n\n\n\nDownload and install R from: https://cran.r-project.org/\nDownload and install RStudio (Desktop version) from: https://posit.co/download/rstudio-desktop/\n\n\n\n\nOpen RStudio and run the following code to install the necessary packages (skip any that are already installed):\n\ninstall.packages(c(\"dplyr\", \"ggplot2\", \"lme4\"))\n\n\n\n\nEnsure the following R script is saved in your working directory (i.e., the folder you will use during the practical):\n\n\nShow contents of simulate_trials.R\n\n\n\nsimulate_trials &lt;- function(\n    baseline_means,\n    n_per_arm = 50,\n    baseline_sd_fn = function(mean) 2 + 0.2 * mean,\n    change_sd = 5,\n    cfb_active,\n    cfb_control,\n    trial_intercepts = NULL,\n    beta_W = NULL, # within-trial effect modification\n    beta_A = 0,   # across-trial effect modification\n    seed = 2025,\n    add_aux_vars = FALSE\n) {\n  set.seed(seed)\n\n  n_trials &lt;- length(baseline_means)\n\n  # Default: no shift\n  if (is.null(trial_intercepts)) {\n    trial_intercepts &lt;- rep(0, n_trials)\n  }\n\n  if (is.null(beta_W)) {\n    beta_W &lt;- rep(0, n_trials)\n  }\n\n  data_list &lt;- lapply(seq_len(n_trials), function(i) {\n    # Step 1: trial-specific mean baseline (X̄_k), around overall mean\n    xk_mean &lt;- baseline_means[i]\n\n    # Step 2: trial-specific baseline SD\n    xk_sd &lt;- baseline_sd_fn(xk_mean)\n\n    # Step 3: simulate treatment (1 = active, 0 = control)\n    trt &lt;- rep(c(1, 0), each = n_per_arm)\n\n    # Step 4: simulate baseline\n    baseline &lt;- c(\n      rnorm(n_per_arm, mean = xk_mean, sd = xk_sd),  # active\n      rnorm(n_per_arm, mean = xk_mean, sd = xk_sd)   # control\n    )\n\n    cbase &lt;- (baseline - xk_mean)\n\n    # Step 5: derive change from baseline due to treatment\n    cfb &lt;- (1-trt) * cfb_control[i]  +  trt * (cfb_active[i])\n\n    # Step 6: derive within-study interaction effect\n    cfb_tx &lt;- trt * beta_W[i] * cbase\n\n    # Step 7: compute change using within-trial and across-trial terms\n    error &lt;- rnorm(2 * n_per_arm, mean = 0, sd = change_sd)\n    outcome &lt;-  trial_intercepts[i] +\n      baseline +\n      cfb +\n      cfb_tx + # Add within-study interaction\n      beta_A * (xk_mean - mean(baseline_means)) +\n      error\n\n    data.frame(\n      trial = paste0(\"Trial_\", i),\n      trt = trt,\n      trta = ifelse(trt == 1, \"Active\", \"Control\"),\n      intercept = trial_intercepts[i],\n      baseline = baseline,\n      cbase = cbase,\n      cfb = cfb,\n      cfb_tx = cfb_tx,\n      error = error,\n      outcome = outcome,\n      change = outcome-baseline,\n      xk_mean = xk_mean\n    )\n  })\n\n  out &lt;- do.call(rbind, data_list)\n  out &lt;- out %&gt;% mutate(trta = factor(ifelse(trt == 1, \"Active\", \"Control\"),\n                                      levels = c(\"Control\", \"Active\")))\n\n  if(!add_aux_vars) {\n    out &lt;- out %&gt;% select(-c(error, intercept,\n                             cfb, cfb_tx))\n  }\n\n  return(out)\n}"
  },
  {
    "objectID": "computer_practical.html#install-r-and-rstudio",
    "href": "computer_practical.html#install-r-and-rstudio",
    "title": "Computer Practical",
    "section": "",
    "text": "Download and install R from: https://cran.r-project.org/\nDownload and install RStudio (Desktop version) from: https://posit.co/download/rstudio-desktop/"
  },
  {
    "objectID": "computer_practical.html#install-required-r-packages",
    "href": "computer_practical.html#install-required-r-packages",
    "title": "Computer Practical",
    "section": "",
    "text": "Open RStudio and run the following code to install the necessary packages (skip any that are already installed):\n\ninstall.packages(c(\"dplyr\", \"ggplot2\", \"lme4\"))"
  },
  {
    "objectID": "computer_practical.html#download-supporting-scripts",
    "href": "computer_practical.html#download-supporting-scripts",
    "title": "Computer Practical",
    "section": "",
    "text": "Ensure the following R script is saved in your working directory (i.e., the folder you will use during the practical):\n\n\nShow contents of simulate_trials.R\n\n\n\nsimulate_trials &lt;- function(\n    baseline_means,\n    n_per_arm = 50,\n    baseline_sd_fn = function(mean) 2 + 0.2 * mean,\n    change_sd = 5,\n    cfb_active,\n    cfb_control,\n    trial_intercepts = NULL,\n    beta_W = NULL, # within-trial effect modification\n    beta_A = 0,   # across-trial effect modification\n    seed = 2025,\n    add_aux_vars = FALSE\n) {\n  set.seed(seed)\n\n  n_trials &lt;- length(baseline_means)\n\n  # Default: no shift\n  if (is.null(trial_intercepts)) {\n    trial_intercepts &lt;- rep(0, n_trials)\n  }\n\n  if (is.null(beta_W)) {\n    beta_W &lt;- rep(0, n_trials)\n  }\n\n  data_list &lt;- lapply(seq_len(n_trials), function(i) {\n    # Step 1: trial-specific mean baseline (X̄_k), around overall mean\n    xk_mean &lt;- baseline_means[i]\n\n    # Step 2: trial-specific baseline SD\n    xk_sd &lt;- baseline_sd_fn(xk_mean)\n\n    # Step 3: simulate treatment (1 = active, 0 = control)\n    trt &lt;- rep(c(1, 0), each = n_per_arm)\n\n    # Step 4: simulate baseline\n    baseline &lt;- c(\n      rnorm(n_per_arm, mean = xk_mean, sd = xk_sd),  # active\n      rnorm(n_per_arm, mean = xk_mean, sd = xk_sd)   # control\n    )\n\n    cbase &lt;- (baseline - xk_mean)\n\n    # Step 5: derive change from baseline due to treatment\n    cfb &lt;- (1-trt) * cfb_control[i]  +  trt * (cfb_active[i])\n\n    # Step 6: derive within-study interaction effect\n    cfb_tx &lt;- trt * beta_W[i] * cbase\n\n    # Step 7: compute change using within-trial and across-trial terms\n    error &lt;- rnorm(2 * n_per_arm, mean = 0, sd = change_sd)\n    outcome &lt;-  trial_intercepts[i] +\n      baseline +\n      cfb +\n      cfb_tx + # Add within-study interaction\n      beta_A * (xk_mean - mean(baseline_means)) +\n      error\n\n    data.frame(\n      trial = paste0(\"Trial_\", i),\n      trt = trt,\n      trta = ifelse(trt == 1, \"Active\", \"Control\"),\n      intercept = trial_intercepts[i],\n      baseline = baseline,\n      cbase = cbase,\n      cfb = cfb,\n      cfb_tx = cfb_tx,\n      error = error,\n      outcome = outcome,\n      change = outcome-baseline,\n      xk_mean = xk_mean\n    )\n  })\n\n  out &lt;- do.call(rbind, data_list)\n  out &lt;- out %&gt;% mutate(trta = factor(ifelse(trt == 1, \"Active\", \"Control\"),\n                                      levels = c(\"Control\", \"Active\")))\n\n  if(!add_aux_vars) {\n    out &lt;- out %&gt;% select(-c(error, intercept,\n                             cfb, cfb_tx))\n  }\n\n  return(out)\n}"
  },
  {
    "objectID": "computer_practical.html#explore-baseline-distributions",
    "href": "computer_practical.html#explore-baseline-distributions",
    "title": "Computer Practical",
    "section": "3.1 Explore Baseline Distributions",
    "text": "3.1 Explore Baseline Distributions\nInvestigate the distribution of the baseline variable:\n\nAre there significant differences in baseline values between the two treatment arms within each trial?\nDoes the baseline distribution vary between trials?"
  },
  {
    "objectID": "computer_practical.html#visual-diagnostics",
    "href": "computer_practical.html#visual-diagnostics",
    "title": "Computer Practical",
    "section": "3.2 Visual Diagnostics",
    "text": "3.2 Visual Diagnostics\nCreate a scatter plot showing individual outcome values as a function of baseline, separately for each trial. An example is given by Torgersen et al. (2011) (Figure 2). You can generate the plot as follows:\n\nggplot(df, aes(x = baseline, y = outcome, color = trta)) +\n  geom_point(alpha = 0.6) +\n  facet_wrap(~trial) +\n  labs(\n    title = \"Observed Outcomes by Baseline Severity and Trial\",\n    x = \"Baseline Severity\",\n    y = \"Outcome\"\n  ) +\n  theme_minimal()\n\nUse the plot to guide your expectations before fitting a model:\n\nDoes the treatment effect appear to vary by trial?\nDoes the treatment effect appear to vary with baseline severity?\nBased on the plot, would a naive pooled analysis (ignoring trial structure) seem appropriate?"
  },
  {
    "objectID": "computer_practical.html#estimation-of-treatment-effect",
    "href": "computer_practical.html#estimation-of-treatment-effect",
    "title": "Computer Practical",
    "section": "3.3 Estimation of treatment effect",
    "text": "3.3 Estimation of treatment effect\nWe now adopt a naive pooling approach, combining data from all trials and adjusting for baseline severity. The treatment effect (active vs. control) is estimated as follows:\n\nglm(outcome ~ trta + baseline, data = df)\n\nAfter fitting the model, consider the following questions:\n\nWhat is the estimated treatment effect?\nIs the estimated effect consistent with the visual patterns in the plot?\nDo you think this model provides a valid summary of the treatment effect? Why or why not?\n\nNow fit a stratified model that allows each trial to have its own intercept:\n\nglm(outcome ~ -1 + trial + trta + baseline, data = df)\n\nThis model accounts for differences in average outcome levels across trials, while still estimating a common treatment effect and adjusting for baseline severity.\n\nWhat is the estimated treatment effect (trtaActive)?\nCompare the trial-specific intercepts. Are they similar across trials, or is there meaningful variation?\nDo the intercept estimates align with what you observed in the scatter plot?\nBased on the model output, does the stratified approach seem more appropriate than the naive pooled analysis? Justify your answer."
  },
  {
    "objectID": "computer_practical.html#explore-baseline-distributions-1",
    "href": "computer_practical.html#explore-baseline-distributions-1",
    "title": "Computer Practical",
    "section": "4.1 Explore Baseline Distributions",
    "text": "4.1 Explore Baseline Distributions\nInvestigate the distribution of the baseline variable:\n\nAre there significant differences in baseline values between the two treatment arms within each trial?\nDoes the baseline distribution vary between trials?"
  },
  {
    "objectID": "computer_practical.html#visual-diagnostics-1",
    "href": "computer_practical.html#visual-diagnostics-1",
    "title": "Computer Practical",
    "section": "4.2 Visual Diagnostics",
    "text": "4.2 Visual Diagnostics\nCreate a scatter plot showing individual outcome values as a function of baseline, separately for each trial. Use the plot to guide your expectations before fitting a model:\n\nDoes the treatment effect appear to vary by trial?\nDoes the treatment effect appear to vary with baseline severity?\nBased on the plot, would a naive pooled analysis (ignoring trial structure) seem appropriate?"
  },
  {
    "objectID": "computer_practical.html#estimation-of-treatment-effect-1",
    "href": "computer_practical.html#estimation-of-treatment-effect-1",
    "title": "Computer Practical",
    "section": "4.3 Estimation of treatment effect",
    "text": "4.3 Estimation of treatment effect\n\nEstimate the treatment effect using naive pooling.\nEstimate the treatment effect using a stratified model.\nCompare the results of the two models. How do they differ in terms of treatment effect estimates and trial intercepts?\n\nInstead of estimating a separate fixed intercept for each trial, we can model trial-specific intercepts as random effects. This approach assumes that the intercepts for each trial are not fixed but drawn from a common normal distribution.\n\nlmer(outcome ~  trta + baseline + (1|trial), data = df)\n\n\nExtract the estimated effects using the function coef()\nWhat is the estimated treatment effect?\nWhat are the estimated trial-specific intercepts?\nHow do these intercepts compare to those from the stratified model? Tip: You may compare the standard deviation of the trial intercepts across models to assess how much variability is captured or shrunk in the random-effects approach."
  },
  {
    "objectID": "computer_practical.html#visual-diagnostics-2",
    "href": "computer_practical.html#visual-diagnostics-2",
    "title": "Computer Practical",
    "section": "5.1 Visual Diagnostics",
    "text": "5.1 Visual Diagnostics\nCreate a scatter plot showing individual outcome values as a function of baseline, separately for each trial. Use the plot to guide your expectations before fitting a model:\n\nDoes the treatment effect appear to vary by trial?\nDoes the treatment effect appear to vary with baseline severity?\nBased on the plot, would a naive pooled analysis (ignoring trial structure) seem appropriate?"
  },
  {
    "objectID": "computer_practical.html#estimation-of-treatment-effect-2",
    "href": "computer_practical.html#estimation-of-treatment-effect-2",
    "title": "Computer Practical",
    "section": "5.2 Estimation of treatment effect",
    "text": "5.2 Estimation of treatment effect\nIn this scenario, we investigate the presence of heterogeneous treatment effects using a linear mixed model with random slopes for treatment and fixed intercepts by trial:\n\nlmer(outcome ~ -1 + trial +  baseline:trial + trt + \n       (0 + trt | trial), data = df)\n\nIn this formula:\n\n-1 + trial: Fixed intercept per trial\nbaseline:trial Fixed effect for baseline severity per trial\ntrt: Pooled treatment effect\n(0 + trt | trial): Random treatment effect per trial\n\nWe can extract key parameters as follows:\n\n# Pooled treatment effect\nfixef(fit)[\"trt\"]\n\n# Standard error of the treatment effect\nsqrt(vcov(fit)[\"trt\", \"trt\"])\n\n# Between-study variance of the treatment effect\nVarCorr(fit)$trial[\"trt\", \"trt\"]\n\nUse the estimates above to derive an approximate 95% confidence interval and 95% prediction interval for the treatment effect.\nBased on the model output:\n\nWhat is the estimated between-trial variance of the treatment effect (τ²)?\nHow does the 95% prediction interval compare to the confidence interval of the pooled treatment effect?\nDo the trial-specific treatment effects (from the plot or model output) vary meaningfully across trials?\nWhat might this imply about the assumption of a common treatment effect?\n\nOptional: Plot the trial-specific treatment effects and overlay the pooled estimate with its prediction interval."
  },
  {
    "objectID": "computer_practical.html#modeling-treatment-effect-modification",
    "href": "computer_practical.html#modeling-treatment-effect-modification",
    "title": "Computer Practical",
    "section": "5.3 Modeling treatment-effect modification",
    "text": "5.3 Modeling treatment-effect modification\nWe suspect that the heterogeneity in treatment effect may be explained by differences in baseline severity across patients. To explore this, we include a common interaction effect between treatment and baseline in the model:\n\nlmer(outcome ~ -1 + trial + baseline:trial + trt + \n       trt:baseline + (0 + trt | trial) , data = df)\n\n\nWhich parameter in the model quantifies the pooled interaction effect?\nWhat does the sign and magnitude of the interaction coefficient (trt:baseline) tell you?\nHow should we interpret this interaction term in the context of treatment-effect modification?\nIs the model appropriate for separating within- and across-study interaction effects?\nHow can we evaluate whether residual heterogeneity in treatment effect remains, despite modeling the interaction?\n\nWe now fit a regression model that explicitly separates within- from across-trial interaction:\n\nlmer(outcome ~ -1 + trial + baseline:trial + trt:trial + \n       trt:baseline + (0 + trt:baseline | trial) , data = df)\n\nIn this formula:\n\n-1 + trial: Fixed intercept per trial\nbaseline:trial: Fixed effect for baseline severity per trial\ntrt:trial : Fixed treatment effect per trial\nbaseline:trt: Pooled within-study interaction between baseline and treatment\n(0 + trt:baseline | trial): Trial-specific deviations from the pooled interaction\n\nQuestions for Discussion\n\nHow does this model help distinguish within- from across-trial interactions?\nWhat does the variance component for the random slope (0 + trt:baseline | trial) represent?\nHow can we use this model to examine inconsistency or effect modification across trials?\n\nFinally, we consider an extended model that also adjusts for trial-level confounding using study-level means:\n\nlmer(\n  outcome ~ -1 + trial + trt + trial:baseline + trt:cbase +xk_mean:trt+\n    (0 + trt | trial) + (0 + trt:cbase | trial),\n  data = df\n)\n\nIn this formula:\n\nxk_mean:trt: Common effect for study-level confounding\ntrt:cbase: Pooled within-study interaction between baseline and treatment\n(0 + trt | trial): Random treatment effects\n(0 + trt:cbase | trial): Random interaction effects\n\nQuestions for Discussion\n\nWhat role does xk_mean:trt play in this model? How does it address ecological bias?\nUnder what conditions might the inclusion of study-level means improve model validity?\nHow do you interpret the presence of both fixed and random interaction terms in this model?\nWould you expect this model to reduce between-trial heterogeneity in treatment effects? Why or why not?"
  }
]